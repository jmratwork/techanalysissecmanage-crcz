# PowerShell script to load malware simulation
param(
    [string]$SimulationScript = "benign_malware_simulator.ps1",
    [string]$Controller = "localhost"
)

Write-Host "Installing required modules..."
try {
    if (-not (Get-Command Invoke-WebRequest -ErrorAction SilentlyContinue)) {
        Install-PackageProvider -Name NuGet -Force | Out-Null
        Install-Module -Name PowerShellGet -Force | Out-Null
    }
} catch {
    Write-Warning "Failed to install PowerShell modules: $_"
}

if (Test-Path $SimulationScript) {
    Write-Host "Running simulation against $Controller"
    & $SimulationScript -Controller $Controller
} else {
    Write-Error "Simulation script '$SimulationScript' not found."
}
